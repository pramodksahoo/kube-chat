# KubeChat API Gateway Service Environment Configuration
# Copy this file to .env and configure values for your deployment

# =============================================================================
# SERVICE CONFIGURATION
# =============================================================================

# Service identification
SERVICE_NAME=api-gateway
SERVICE_VERSION=dev
SERVICE_ENVIRONMENT=development

# Server configuration
HOST=0.0.0.0
PORT=8080
SHUTDOWN_TIMEOUT=30s

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================

# Logging settings
LOG_LEVEL=info
LOG_FORMAT=json
LOG_OUTPUT=stdout

# Request logging
ACCESS_LOG_ENABLED=true
ACCESS_LOG_FORMAT=combined

# =============================================================================
# CORS CONFIGURATION
# =============================================================================

# Cross-Origin Resource Sharing
CORS_ENABLED=true
CORS_ORIGINS=http://localhost:3000,http://localhost:5173,https://kubechat.local
CORS_METHODS=GET,POST,PUT,DELETE,OPTIONS,PATCH
CORS_HEADERS=Content-Type,Authorization,X-Requested-With
CORS_CREDENTIALS=true
CORS_MAX_AGE=86400

# =============================================================================
# SECURITY CONFIGURATION
# =============================================================================

# TLS/HTTPS configuration
TLS_ENABLED=false
TLS_CERT_PATH=/etc/certs/tls.crt
TLS_KEY_PATH=/etc/certs/tls.key

# Security headers
SECURE_HEADERS_ENABLED=true
HSTS_ENABLED=false
HSTS_MAX_AGE=31536000

# Authentication
JWT_SECRET=your-jwt-secret-change-this-in-production
JWT_EXPIRATION=24h
JWT_ISSUER=kubechat-api-gateway

# API Keys (if using API key authentication)
API_KEY_HEADER=X-API-Key
API_KEY_REQUIRED=false

# =============================================================================
# RATE LIMITING CONFIGURATION
# =============================================================================

# Rate limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_RPM=1000
RATE_LIMIT_BURST=100
RATE_LIMIT_WINDOW=60s

# Rate limiting storage
RATE_LIMIT_STORAGE=redis
RATE_LIMIT_KEY_PREFIX=ratelimit:

# =============================================================================
# DATABASE CONNECTIONS
# =============================================================================

# PostgreSQL configuration
POSTGRES_HOST=kubechat-postgresql
POSTGRES_PORT=5432
POSTGRES_DB=kubechat_audit_dev
POSTGRES_USER=kubechat_user
POSTGRES_PASSWORD=dev-kubechat-password
POSTGRES_SSL_MODE=prefer

# Connection pooling
POSTGRES_MAX_CONNECTIONS=25
POSTGRES_MAX_IDLE_CONNECTIONS=5
POSTGRES_CONN_MAX_LIFETIME=1h
POSTGRES_CONN_MAX_IDLE_TIME=10m

# =============================================================================
# REDIS CONFIGURATION
# =============================================================================

# Redis connection
REDIS_HOST=kubechat-redis-master
REDIS_PORT=6379
REDIS_PASSWORD=dev-redis-password
REDIS_DB=0

# Redis connection settings
REDIS_MAX_RETRIES=3
REDIS_RETRY_DELAY=1s
REDIS_POOL_SIZE=10
REDIS_MIN_IDLE_CONNS=5
REDIS_DIAL_TIMEOUT=5s
REDIS_READ_TIMEOUT=3s
REDIS_WRITE_TIMEOUT=3s

# =============================================================================
# MICROSERVICES COMMUNICATION
# =============================================================================

# Kubernetes Operator service
OPERATOR_SERVICE_HOST=kubechat-operator
OPERATOR_SERVICE_PORT=8080
OPERATOR_SERVICE_TIMEOUT=30s

# Audit Service
AUDIT_SERVICE_HOST=kubechat-audit-service
AUDIT_SERVICE_PORT=8082
AUDIT_SERVICE_TIMEOUT=10s

# Web Frontend (for WebSocket proxying)
WEB_SERVICE_HOST=kubechat-web
WEB_SERVICE_PORT=80

# =============================================================================
# WEBSOCKET CONFIGURATION
# =============================================================================

# WebSocket settings
WEBSOCKET_ENABLED=true
WEBSOCKET_PATH=/ws
WEBSOCKET_READ_BUFFER=1024
WEBSOCKET_WRITE_BUFFER=1024
WEBSOCKET_PING_PERIOD=54s
WEBSOCKET_PONG_WAIT=60s
WEBSOCKET_WRITE_WAIT=10s

# WebSocket authentication
WEBSOCKET_AUTH_REQUIRED=true
WEBSOCKET_ORIGIN_CHECK=true

# =============================================================================
# KUBERNETES API INTEGRATION
# =============================================================================

# Kubernetes API configuration
KUBECONFIG_PATH=/etc/kubeconfig/config
K8S_NAMESPACE=kubechat-dev
K8S_IN_CLUSTER=true

# Kubernetes API timeouts
K8S_API_TIMEOUT=30s
K8S_API_QPS=50
K8S_API_BURST=100

# =============================================================================
# EXTERNAL SERVICES
# =============================================================================

# LLM Service integration
LLM_ENABLED=true
LLM_PROVIDER=ollama
LLM_ENDPOINT=http://host.docker.internal:11434
LLM_MODEL=llama3.2
LLM_TIMEOUT=60s
# LLM_API_KEY=your_llm_api_key

# SIEM Integration
SIEM_ENABLED=false
# SIEM_ENDPOINT=https://your-siem.company.com
# SIEM_TOKEN=your_siem_token
# SIEM_TIMEOUT=10s

# =============================================================================
# MONITORING AND METRICS
# =============================================================================

# Metrics configuration
METRICS_ENABLED=true
METRICS_PORT=8080
METRICS_PATH=/metrics

# Health checks
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_PATH=/health
HEALTH_CHECK_TIMEOUT=5s

# Readiness checks
READINESS_CHECK_ENABLED=true
READINESS_CHECK_PATH=/ready

# =============================================================================
# PERFORMANCE TUNING
# =============================================================================

# HTTP server settings
MAX_HEADER_BYTES=1048576
READ_TIMEOUT=15s
WRITE_TIMEOUT=15s
IDLE_TIMEOUT=60s
MAX_REQUEST_SIZE=32Mi

# Connection limits
MAX_CONCURRENT_CONNECTIONS=1000
KEEP_ALIVE_TIMEOUT=75s

# Worker configuration
WORKER_POOL_SIZE=10
QUEUE_SIZE=1000

# =============================================================================
# CACHING CONFIGURATION
# =============================================================================

# Response caching
RESPONSE_CACHE_ENABLED=true
RESPONSE_CACHE_TTL=5m
RESPONSE_CACHE_SIZE=100MB

# Static asset caching
STATIC_CACHE_ENABLED=true
STATIC_CACHE_TTL=1h

# =============================================================================
# DEVELOPMENT SETTINGS
# =============================================================================

# Development mode
DEBUG_MODE=true
DEV_MODE=true
HOT_RELOAD=true

# Request/Response logging
REQUEST_LOGGING=true
RESPONSE_LOGGING=false
BODY_LOGGING=false

# Profiling
PROFILING_ENABLED=false
PPROF_ENABLED=false

# =============================================================================
# AUDIT AND COMPLIANCE
# =============================================================================

# Request auditing
AUDIT_REQUESTS=true
AUDIT_RESPONSES=false
AUDIT_HEADERS=true
AUDIT_BODY=false

# Compliance settings
GDPR_MODE=false
HIPAA_MODE=false
SOC2_MODE=false

# Data retention
REQUEST_LOG_RETENTION=7d
AUDIT_LOG_RETENTION=30d

# =============================================================================
# ERROR HANDLING
# =============================================================================

# Error handling
DETAILED_ERRORS=true
STACK_TRACES=true
ERROR_LOGGING=true

# Circuit breaker
CIRCUIT_BREAKER_ENABLED=true
CIRCUIT_BREAKER_TIMEOUT=30s
CIRCUIT_BREAKER_MAX_REQUESTS=10
CIRCUIT_BREAKER_INTERVAL=60s
CIRCUIT_BREAKER_RATIO=0.5

# =============================================================================
# FEATURE FLAGS
# =============================================================================

# API Gateway features
FEATURE_GRAPHQL=false
FEATURE_GRPC_GATEWAY=false
FEATURE_API_VERSIONING=true
FEATURE_REQUEST_VALIDATION=true

# Security features
FEATURE_OAUTH2=false
FEATURE_MUTUAL_TLS=false
FEATURE_API_KEYS=false

# Observability features
FEATURE_DISTRIBUTED_TRACING=false
FEATURE_STRUCTURED_LOGGING=true
FEATURE_REQUEST_ID=true