# KubeChat Audit Service Environment Configuration
# Copy this file to .env and configure values for your deployment

# =============================================================================
# SERVICE CONFIGURATION
# =============================================================================

# Service identification
SERVICE_NAME=audit-service
SERVICE_VERSION=dev
SERVICE_ENVIRONMENT=development

# Server configuration
HOST=0.0.0.0
PORT=8082
SHUTDOWN_TIMEOUT=30s

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================

# Logging settings
LOG_LEVEL=info
LOG_FORMAT=json
LOG_OUTPUT=stdout

# Audit-specific logging
AUDIT_LOG_LEVEL=debug
AUDIT_LOG_SEPARATE=true
AUDIT_LOG_PATH=/var/log/audit

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================

# PostgreSQL configuration for audit storage
POSTGRES_HOST=kubechat-postgresql
POSTGRES_PORT=5432
POSTGRES_DB=kubechat_audit_dev
POSTGRES_USER=kubechat_user
POSTGRES_PASSWORD=dev-kubechat-password
POSTGRES_SSL_MODE=prefer

# Connection pooling for high-throughput audit logging
POSTGRES_MAX_CONNECTIONS=50
POSTGRES_MAX_IDLE_CONNECTIONS=10
POSTGRES_CONN_MAX_LIFETIME=1h
POSTGRES_CONN_MAX_IDLE_TIME=10m

# Database performance tuning
POSTGRES_PREPARE_STATEMENTS=true
POSTGRES_BATCH_SIZE=1000
POSTGRES_FLUSH_INTERVAL=5s

# =============================================================================
# REDIS CONFIGURATION
# =============================================================================

# Redis for audit event buffering
REDIS_HOST=kubechat-redis-master
REDIS_PORT=6379
REDIS_PASSWORD=dev-redis-password
REDIS_DB=1

# Redis connection settings
REDIS_MAX_RETRIES=3
REDIS_RETRY_DELAY=1s
REDIS_POOL_SIZE=20
REDIS_MIN_IDLE_CONNS=5
REDIS_DIAL_TIMEOUT=5s

# Audit event buffering
REDIS_BUFFER_KEY=audit:events
REDIS_BUFFER_MAX_SIZE=10000
REDIS_BUFFER_TTL=24h

# =============================================================================
# AUDIT CONFIGURATION
# =============================================================================

# Audit event processing
AUDIT_BATCH_SIZE=100
AUDIT_FLUSH_INTERVAL=5s
AUDIT_QUEUE_SIZE=10000
AUDIT_WORKER_COUNT=5

# Audit data retention
AUDIT_RETENTION_DAYS=30
AUDIT_ARCHIVE_ENABLED=true
AUDIT_ARCHIVE_AFTER_DAYS=90
AUDIT_CLEANUP_INTERVAL=24h

# Audit event types
AUDIT_AUTHENTICATION_EVENTS=true
AUDIT_AUTHORIZATION_EVENTS=true
AUDIT_RESOURCE_EVENTS=true
AUDIT_SYSTEM_EVENTS=true
AUDIT_USER_EVENTS=true

# =============================================================================
# TAMPER-PROOF AUDIT CONFIGURATION
# =============================================================================

# Tamper-proof audit settings
AUDIT_TAMPER_PROOF=true
AUDIT_CHECKSUM_VALIDATION=true
AUDIT_CHAIN_ENABLED=true
AUDIT_DIGITAL_SIGNING=false

# Checksumming configuration
CHECKSUM_ALGORITHM=SHA256
CHECKSUM_SALT=your-checksum-salt-change-this
CHECKSUM_VERIFICATION_INTERVAL=1h

# Audit chain configuration
AUDIT_CHAIN_BLOCK_SIZE=1000
AUDIT_CHAIN_HASH_ALGORITHM=SHA256
AUDIT_CHAIN_VERIFICATION_INTERVAL=6h

# =============================================================================
# SECURITY CONFIGURATION
# =============================================================================

# TLS configuration
TLS_ENABLED=false
TLS_CERT_PATH=/etc/certs/tls.crt
TLS_KEY_PATH=/etc/certs/tls.key

# Encryption for sensitive audit data
ENCRYPTION_ENABLED=true
ENCRYPTION_KEY=your-32-character-encryption-key-here
ENCRYPTION_ALGORITHM=AES256

# Authentication for audit service API
API_AUTH_ENABLED=true
API_AUTH_TYPE=bearer
API_AUTH_TOKEN=your-audit-service-token

# =============================================================================
# SIEM INTEGRATION
# =============================================================================

# SIEM forwarding
SIEM_ENABLED=false
SIEM_PROVIDER=splunk
# SIEM_ENDPOINT=https://your-siem.company.com
# SIEM_TOKEN=your_siem_token
SIEM_TIMEOUT=10s
SIEM_BATCH_SIZE=100
SIEM_FLUSH_INTERVAL=30s

# SIEM event filtering
SIEM_FORWARD_ALL_EVENTS=false
SIEM_FORWARD_CRITICAL_EVENTS=true
SIEM_FORWARD_SECURITY_EVENTS=true

# =============================================================================
# MONITORING AND METRICS
# =============================================================================

# Metrics configuration
METRICS_ENABLED=true
METRICS_PORT=8082
METRICS_PATH=/metrics

# Audit-specific metrics
AUDIT_METRICS_ENABLED=true
AUDIT_METRICS_INTERVAL=60s

# Health checks
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_PATH=/health
HEALTH_CHECK_TIMEOUT=5s

# Database health monitoring
DB_HEALTH_CHECK_INTERVAL=30s
DB_HEALTH_CHECK_TIMEOUT=10s

# =============================================================================
# PERFORMANCE TUNING
# =============================================================================

# HTTP server settings
READ_TIMEOUT=15s
WRITE_TIMEOUT=15s
IDLE_TIMEOUT=60s
MAX_HEADER_BYTES=1048576

# Audit processing performance
ASYNC_PROCESSING=true
WORKER_POOL_SIZE=10
CHANNEL_BUFFER_SIZE=1000

# Memory management
MAX_MEMORY_USAGE=80%
GC_TARGET_PERCENT=75

# =============================================================================
# COMPLIANCE CONFIGURATION
# =============================================================================

# Regulatory compliance
COMPLIANCE_MODE=standard
GDPR_COMPLIANCE=false
HIPAA_COMPLIANCE=false
SOC2_COMPLIANCE=false
PCI_DSS_COMPLIANCE=false

# Audit trail requirements
IMMUTABLE_AUDIT_TRAIL=true
TIMESTAMPING_ENABLED=true
NON_REPUDIATION=true

# Data classification
DATA_CLASSIFICATION_ENABLED=false
SENSITIVE_DATA_MASKING=true
PII_DETECTION=false

# =============================================================================
# BACKUP AND RECOVERY
# =============================================================================

# Backup configuration
BACKUP_ENABLED=false
BACKUP_INTERVAL=6h
BACKUP_RETENTION=30d

# Backup storage
# BACKUP_TYPE=s3
# BACKUP_S3_BUCKET=your-audit-backup-bucket
# BACKUP_S3_REGION=us-west-2
# AWS_ACCESS_KEY_ID=your_access_key
# AWS_SECRET_ACCESS_KEY=your_secret_key

# Point-in-time recovery
PITR_ENABLED=false
WAL_ARCHIVING=false

# =============================================================================
# DEVELOPMENT SETTINGS
# =============================================================================

# Development mode
DEBUG_MODE=true
DEV_MODE=true
VERBOSE_LOGGING=true

# Test data
GENERATE_TEST_EVENTS=false
TEST_EVENT_COUNT=1000
TEST_EVENT_INTERVAL=1s

# Mock integrations
MOCK_SIEM=true
MOCK_EXTERNAL_SERVICES=true

# =============================================================================
# ALERTING CONFIGURATION
# =============================================================================

# Alert settings
ALERTING_ENABLED=false
ALERT_CHANNEL=webhook
# ALERT_WEBHOOK_URL=https://your-webhook-url
# ALERT_SLACK_TOKEN=your_slack_token
# ALERT_EMAIL_SMTP=smtp.company.com

# Alert conditions
ALERT_ON_AUDIT_FAILURE=true
ALERT_ON_TAMPER_DETECTION=true
ALERT_ON_HIGH_ERROR_RATE=true
ALERT_ON_DATABASE_ISSUES=true

# Alert thresholds
ERROR_RATE_THRESHOLD=5%
PROCESSING_DELAY_THRESHOLD=60s
DISK_USAGE_THRESHOLD=90%

# =============================================================================
# KAFKA/MESSAGE QUEUE INTEGRATION (Optional)
# =============================================================================

# Message queue for audit events
MESSAGE_QUEUE_ENABLED=false
# MESSAGE_QUEUE_TYPE=kafka
# KAFKA_BROKERS=kafka-broker-1:9092,kafka-broker-2:9092
# KAFKA_TOPIC=audit-events
# KAFKA_CONSUMER_GROUP=audit-service

# =============================================================================
# SEARCH AND INVESTIGATION
# =============================================================================

# Search capabilities
SEARCH_ENABLED=true
SEARCH_INDEX_ENABLED=false
# ELASTICSEARCH_URL=http://elasticsearch:9200
# ELASTICSEARCH_INDEX=audit-logs

# Full-text search
FULL_TEXT_SEARCH=true
SEARCH_RETENTION_DAYS=90

# =============================================================================
# API CONFIGURATION
# =============================================================================

# REST API settings
API_ENABLED=true
API_BASE_PATH=/api/v1
API_RATE_LIMIT=1000
API_PAGINATION_SIZE=100
API_MAX_PAGE_SIZE=1000

# GraphQL API (optional)
GRAPHQL_ENABLED=false
GRAPHQL_PATH=/graphql
GRAPHQL_PLAYGROUND=true

# =============================================================================
# FEATURE FLAGS
# =============================================================================

# Audit service features
FEATURE_REAL_TIME_PROCESSING=true
FEATURE_BATCH_PROCESSING=true
FEATURE_STREAM_PROCESSING=false

# Security features
FEATURE_ENCRYPTION_AT_REST=true
FEATURE_ENCRYPTION_IN_TRANSIT=false
FEATURE_FIELD_LEVEL_ENCRYPTION=false

# Integration features
FEATURE_WEBHOOK_NOTIFICATIONS=false
FEATURE_EMAIL_NOTIFICATIONS=false
FEATURE_SLACK_NOTIFICATIONS=false